<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Internet Offers</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
    <!-- Custom styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header class="py-4 mb-4 bg-primary">
        <div class="container-fluid">
            <h1 class="text-white m-0 fs-2">C</h1>
        </div>
    </header>

    <main>
        <!-- Address input section -->
        <section class="container my-5">
            <div class="row justify-content-center align-items-stretch g-4">
                <!-- Left card: Prompt text -->
                <div class="col-md-6 d-flex">
                    <div class="card flex-fill py-5 px-4 d-flex align-items-center justify-content-center">
                        <h2 class="fw-medium text-left fs-2">Enter your address to start comparing</h2>
                    </div>
                </div>
                <!-- Right card: Address form -->
                <div class="col-md-6 d-flex">
                    <div class="card flex-fill pt-5 pb-3 px-3 d-flex flex-column justify-content-center">
                        <form id="address-form">
                            <!-- PLZ and City -->
                            <div class="row g-2">
                                <div class="col-md-6">
                                    <input class="form-control" type="text" id="plz" name="plz" placeholder="PLZ">
                                </div>
                                <div class="col-md-6">
                                    <input class="form-control" type="text" id="city" name="city" placeholder="City">
                                </div>
                            </div>
                            <!-- Street and House Number -->
                            <div class="row g-2 mt-2">
                                <div class="col-md-8">
                                    <input class="form-control" type="text" id="street" name="street" placeholder="Street">
                                </div>
                                <div class="col-md-4">
                                    <input class="form-control" type="text" id="house_number" name="house_number" placeholder="Nr.">
                                </div>
                            </div>
                            <!-- Age and Show All Offers -->
                            <div class="row g-2 mt-2 align-items-center">
                                <div class="col-md-6">
                                    <input class="form-control" type="number" id="age_input" min="0" placeholder="Age (optional)">
                                </div>
                                <div class="col-md-6 d-flex align-items-center">
                                    <input type="checkbox" id="show_all_ages" class="form-check-input me-2" checked>
                                    <label class="form-check-label" for="show_all_ages">Show me all offers</label>
                                </div>
                            </div>
                            <!-- Search Button -->
                            <div class="row mt-3">
                                <div class="col-12">
                                    <button id="search-btn" type="button" class="btn btn-primary w-100">Search</button>
                                </div>
                            </div>
                            <!-- Error message -->
                            <div class="row mt-1">
                                <div class="col">
                                    <div id="address-error-container" style="min-height:2em;">
                                        <div id="address-error" class="text-danger mb-2 d-none small" role="alert"></div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </section>

        <!-- Offers and Filters section -->
        <section id="main-content" class="container my-5 d-none">
            <div class="row justify-content-center align-items-stretch g-4">
                <!-- Sidebar: Filters -->
                <aside class="col-md-3">
                    <div id="filters" class="card p-3 w-100">
                        <h5 class="mb-3">Filters</h5>
                        <!-- Speed filter -->
                        <div class="mb-3">
                            <label class="mb-1">Min. speed:</label>
                            <div id="speed-buttons" class="d-grid gap-1">
                                <button type="button" data-speed="" class="btn btn-outline-primary">All</button>
                                <button type="button" data-speed="20" class="btn btn-outline-primary">from 20 Mbps</button>
                                <button type="button" data-speed="50" class="btn btn-outline-primary">from 50 Mbps</button>
                                <button type="button" data-speed="100" class="btn btn-outline-primary">from 100 Mbps</button>
                                <button type="button" data-speed="150" class="btn btn-outline-primary">from 150 Mbps</button>
                                <button type="button" data-speed="250" class="btn btn-outline-primary">from 250 Mbps</button>
                            </div>
                        </div>
                        <!-- TV filter -->
                        <div class="mb-3">
                            <label class="mb-1">TV:</label>
                            <div id="tv-buttons" class="d-grid gap-1">
                                <button type="button" data-tv="" class="btn btn-outline-secondary">All</button>
                                <button type="button" data-tv="false" class="btn btn-outline-secondary">Only internet</button>
                                <button type="button" data-tv="true" class="btn btn-outline-secondary">Internet and TV</button>
                            </div>
                        </div>
                        <!-- Data limit filter -->
                        <div class="mb-3">
                            <label class="mb-1">Data limit:</label>
                            <div id="limit-buttons" class="d-grid gap-1">
                                <button type="button" data-limit="" class="btn btn-outline-secondary">All</button>
                                <button type="button" data-limit="100" class="btn btn-outline-secondary">Capped at 100 GB</button>
                                <button type="button" data-limit="200" class="btn btn-outline-secondary">Capped at 200 GB</button>
                                <button type="button" data-limit="300" class="btn btn-outline-secondary">Capped at 300 GB</button>
                                <button type="button" data-limit="none" class="btn btn-outline-secondary">Unlimited</button>
                            </div>
                        </div>
                        <!-- Connection type filter -->
                        <div class="mb-3">
                            <label class="mb-1">Connection type:</label>
                            <div id="connection-type-checkboxes">
                                <div class="form-check mb-1">
                                    <input type="checkbox" value="dsl" class="form-check-input connection-type" id="conn-dsl">
                                    <label class="form-check-label" for="conn-dsl">DSL</label>
                                </div>
                                <div class="form-check mb-1">
                                    <input type="checkbox" value="fiber" class="form-check-input connection-type" id="conn-fiber">
                                    <label class="form-check-label" for="conn-fiber">Fiber</label>
                                </div>
                                <div class="form-check mb-1">
                                    <input type="checkbox" value="cable" class="form-check-input connection-type" id="conn-cable">
                                    <label class="form-check-label" for="conn-cable">Cable</label>
                                </div>
                            </div>
                        </div>
                        <!-- Contract duration filter -->
                        <div class="mb-3">
                            <label class="mb-1">Min. contract duration:</label>
                            <div id="duration-buttons" class="d-grid gap-1">
                                <button type="button" data-duration="" class="btn btn-outline-secondary">Any</button>
                                <button type="button" data-duration="12" class="btn btn-outline-secondary">12 months</button>
                                <button type="button" data-duration="24" class="btn btn-outline-secondary">24 months</button>
                            </div>
                        </div>
                        <!-- Provider filter -->
                        <div class="mb-3">
                            <label class="mb-1">Provider:</label>
                            <div id="provider-checkboxes">
                                <div class="form-check mb-1">
                                    <input type="checkbox" value="ByteMe" class="form-check-input provider" id="provider-ByteMe">
                                    <label class="form-check-label" for="provider-ByteMe">ByteMe</label>
                                </div>
                                <div class="form-check mb-1">
                                    <input type="checkbox" value="WebWunder" class="form-check-input provider" id="provider-WebWunder">
                                    <label class="form-check-label" for="provider-WebWunder">WebWunder</label>
                                </div>
                                <div class="form-check mb-1">
                                    <input type="checkbox" value="Ping Perfect" class="form-check-input provider" id="provider-PingPerfect">
                                    <label class="form-check-label" for="provider-PingPerfect">Ping Perfect</label>
                                </div>
                                <div class="form-check mb-1">
                                    <input type="checkbox" value="Servus Speed" class="form-check-input provider" id="provider-ServusSpeed">
                                    <label class="form-check-label" for="provider-ServusSpeed">Servus Speed</label>
                                </div>
                                <div class="form-check mb-1">
                                    <input type="checkbox" value="VerbynDich" class="form-check-input provider" id="provider-VerbynDich">
                                    <label class="form-check-label" for="provider-VerbynDich">VerbynDich</label>
                                </div>
                            </div>
                        </div>
                        <!-- Installation included filter -->
                        <div class="form-check mb-3 text-start">
                            <input type="checkbox" id="installation_included" name="installation_included" class="form-check-input">
                            <label class="form-check-label" for="installation_included">Installation included</label>
                        </div>
                        <!-- Reset filters button -->
                        <button id="reset-filters" type="button" class="btn btn-outline-secondary w-100 mt-2">Reset filters</button>
                    </div>
                </aside>
                <!-- Main content: Offers/results -->
                <section class="col-md-9 d-flex flex-column">
                    <!-- Sort and summary bar -->
                    <div id="sort-filter-top" class="d-flex justify-content-between align-items-center">
                        <div class="d-flex align-items-center">
                            <div id="loading-spinner" class="me-2 d-none">
                                <div class="spinner-border text-primary" role="status" style="width: 1.5rem; height: 1.5rem;">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                            </div>
                            <div id="offers-summary" class="text-secondary small"></div>
                        </div>                        <div class="d-flex align-items-center">
                            <label for="sort_by" class="me-2 mb-0">Sort by:</label>
                            <select id="sort_by" class="form-select form-select-sm w-auto">
                                <option value="cost_first_years_eur" selected>Mean cost per month</option>
                                <option value="after_two_years_eur">Cost after two years</option>
                                <option value="speed_mbps">Speed</option>
                            </select>
                        </div>
                    </div>
                    <!-- Share button component -->
                    {% include "components/share_btn.html" %}
                    <!-- Offers/results list -->
                    <div id="results" class="row g-1"></div>
                </section>
            </div>
        </section>
    </main>

    <!-- Pass offers and filters from backend to JS -->
    <script>
        {% if offers is defined %}
          window.snapshotOffers = {{ offers|tojson|safe }};
        {% else %}
          window.snapshotOffers = null;
        {% endif %}
        {% if filters is defined %}
          window.snapshotFilters = {{ filters|tojson|safe }};
        {% else %}
          window.snapshotFilters = null;
        {% endif %}
    </script>
    <!-- Main JS module -->
    <script type="module" src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
